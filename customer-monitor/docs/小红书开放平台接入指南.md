# 小红书开放平台接入指南

## 一、注册企业账号

### 1. 注册小红书开放平台
1. 访问 [小红书开放平台](https://developers.xiaohongshu.com/)
2. 注册企业账号（需要营业执照）
3. 完成企业认证

### 2. 创建应用

进入控制台 → 应用管理 → 创建应用：

| 字段 | 填写建议 |
|------|----------|
| 应用名称 | 贷款服务助手 |
| 应用类型 | 工具类 |
| 简介 | 贷款产品查询与咨询服务 |
| 资质 | 营业执照、ICP备案 |

### 3. 申请API权限

需要的权限：

| API | 用途 | 申请难度 |
|-----|------|----------|
| 搜索接口 | 搜索笔记/用户 | ⭐⭐ |
| 私信接口 | 发送私信触达客户 | ⭐⭐⭐⭐⭐ |
| 评论接口 | 评论区互动 | ⭐⭐⭐ |

## 二、API文档

### 1. 搜索接口

```
GET https://open.xiaohongshu.com/api/sns/web/v1/search/notes
```

参数：

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| keyword | string | 是 | 搜索关键词 |
| page | int | 否 | 页码 |
| page_size | int | 否 | 每页数量(最大20) |

响应示例：

```json
{
  "data": {
    "notes": [
      {
        "note_id": "64a1234567890abcdef",
        "title": "征信不好怎么贷款？急！",
        "desc": "之前信用卡逾期过几次...",
        "create_time": 1640995200,
        "author": {
          "nickname": "小仙女",
          "user_id": "u123456"
        }
      }
    ],
    "total": 100,
    "page": 1,
    "page_size": 10
  }
}
```

### 2. 私信接口

```
POST https://open.xiaohongshu.com/api/sns/web/v1/message/send
```

参数：

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| target_user_id | string | 是 | 目标用户ID |
| content | string | 是 | 私信内容(最长500字) |
| msg_type | int | 是 | 消息类型(1=文本) |

### 3. 评论接口

```
POST https://open.xiaohongshu.com/api/sns/web/v1/note/comment
```

参数：

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| note_id | string | 是 | 笔记ID |
| content | string | 是 | 评论内容 |

## 三、Python接入示例

```python
import requests
from urllib.parse import urlencode

class XiaohongshuOpenPlatform:
    """小红书开放平台"""
    
    def __init__(self, client_id, client_secret):
        self.client_id = client_id
        self.client_secret = client_secret
        self.access_token = None
        self.base_url = "https://open.xiaohongshu.com/api/sns/web/v1"
    
    def get_access_token(self):
        """获取access_token"""
        url = f"{self.base_url}/oauth/access_token"
        data = {
            "client_id": self.client_id,
            "client_secret": self.client_secret,
            "grant_type": "client_credential"
        }
        resp = requests.post(url, data=data)
        if resp.status_code == 200:
            self.access_token = resp.json().get("data", {}).get("access_token")
            return self.access_token
        return None
    
    def search_notes(self, keyword, page=1, page_size=10):
        """搜索笔记"""
        url = f"{self.base_url}/search/notes"
        params = {
            "access_token": self.access_token,
            "keyword": keyword,
            "page": page,
            "page_size": page_size
        }
        resp = requests.get(f"{url}?{urlencode(params)}")
        return resp.json()
    
    def send_private_msg(self, target_user_id, content):
        """发送私信"""
        url = f"{self.base_url}/message/send"
        data = {
            "access_token": self.access_token,
            "target_user_id": target_user_id,
            "content": content,
            "msg_type": 1
        }
        resp = requests.post(url, json=data)
        return resp.json()
    
    def send_comment(self, note_id, content):
        """发送评论"""
        url = f"{self.base_url}/note/comment"
        data = {
            "access_token": self.access_token,
            "note_id": note_id,
            "content": content
        }
        resp = requests.post(url, json=data)
        return resp.json()


# 使用示例
if __name__ == "__main__":
    # 配置
    CLIENT_ID = "your_client_id"
    CLIENT_SECRET = "your_client_secret"
    
    # 初始化
    xhs = XiaohongshuOpenPlatform(CLIENT_ID, CLIENT_SECRET)
    token = xhs.get_access_token()
    
    # 搜索笔记
    result = xhs.search_notes("贷款")
    print(result)
```

## 四、注意事项

### 1. 审核要求
- 私信功能很难申请（需要特殊资质）
- 评论功能相对容易
- 搜索功能需要申请

### 2. 频率限制
- 搜索：60次/分钟
- 私信：30次/小时
- 评论：20次/小时

### 3. 内容规范
- 私信不能包含外部链接
- 不能发送重复内容
- 需要用户授权

## 五、替代方案（无API）

小红书的API申请比较困难，建议使用：

### 1. 小红书网页版爬取
```python
import requests
from bs4 import BeautifulSoup

class XiaohongshuSpider:
    """小红书爬虫"""
    
    def search_notes(self, keyword, page=1):
        """搜索笔记"""
        url = f"https://www.xiaohongshu.com/search/{keyword}"
        headers = {
            "User-Agent": "Mozilla/5.0 (iPhone; CPU iPhone OS 14_0 like Mac OS X)"
        }
        resp = requests.get(url, headers=headers)
        # 解析HTML
        pass
```

### 2. 小红书评论区监控
```python
def monitor_note_comments(note_url):
    """监控笔记评论区"""
    pass
```

### 3. 小红书话题监控
```python
def monitor_xiaohongshu_topics():
    """监控贷款相关话题"""
    pass
```

## 六、常见问题

### Q: 小红书API申请需要多久？
A: 搜索接口1-3天，私信接口可能需要1-2周甚至更久

### Q: 私信功能申请被拒怎么办？
A: 私信功能目前只对部分优质企业开放，普通应用很难申请到

### Q: 如何判断笔记是否有贷款需求？
A: 使用关键词匹配 + AI分析

### Q: 小红书有什么特殊限制？
A: 对导流行为监控很严格，容易被封号

## 七、小红书风控特别提醒

相比抖音，小红书的风控更严格：

| 风险点 | 抖音 | 小红书 |
|--------|------|--------|
| 私信监控 | 中等 | 严格 |
| 关键词检测 | 中等 | 严格 |
| 导流检测 | 中等 | 非常严格 |
| 封号概率 | 低 | 中等 |

### 安全做法

1. **不直接导流**
   - 引导到主页 → 私信 → 转换
   - 不要在评论中留联系方式

2. **内容要自然**
   - 不要发布纯广告
   - 以分享知识为主

3. **账号矩阵**
   - 准备多个账号
   - 一个被封不影响整体

## 八、推荐方案

由于小红书API申请困难，建议：

1. **短期**: 使用爬虫方式获取笔记/评论
2. **中期**: 使用官方API的搜索功能
3. **长期**: 积累粉丝，自然获客

对于获客，重点监控以下关键词：
- 征信问题：征信逾期、征信花了、黑户
- 贷款需求：急需贷款、贷款被拒、哪个银行
- 消费场景：装修贷、车贷、买房
