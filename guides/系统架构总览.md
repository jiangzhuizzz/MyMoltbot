# MyMoltbot 系统架构总览

> 最后更新: 2026-02-01
> 目标：清晰理解各模块关系和呈现方式

---

## 🏠 一、整体架构图

```
┌─────────────────────────────────────────────────────────────────┐
│                        用户层                                    │
│  ┌──────────────┐    ┌──────────────┐    ┌──────────────┐       │
│  │   WhatsApp   │    │   微信/其他  │    │  本地App     │       │
│  └──────────────┘    └──────────────┘    └──────────────┘       │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                     Clawdbot AI 层                              │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │  Clawdbot（AI助手）                                       │   │
│  │  - 理解用户需求                                           │   │
│  │  - 协调各模块                                             │   │
│  │  - 返回结果                                               │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
          ┌───────────────────┼───────────────────┐
          ▼                   ▼                   ▼
┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐
│   网页端        │ │   命令行工具    │ │   数据存储      │
│  Obsidian +     │ │   CLI工具       │ │   数据库        │
│  VS Code/       │ │   (OpenCode)    │ │   (JSON/文件)   │
│  Claude Code    │ │                 │ │                 │
└─────────────────┘ └─────────────────┘ └─────────────────┘
```

---

## 🎯 二、核心功能 vs 其他功能

### 2.1 功能层级

```
┌─────────────────────────────────────────────────────────────┐
│                    🎯 核心功能（必须做）                      │
├─────────────────────────────────────────────────────────────┤
│  1. 客户获取（搜索 → 触达 → CRM管理）                        │
│  2. 产品管理（产品库 → 搜索 → 对比）                         │
│  3. 效率工具（早报 → 任务管理）                              │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                   ⭐ 重要功能（优先做）                       │
├─────────────────────────────────────────────────────────────┤
│  1. 自媒体运营（小红书/抖音矩阵）                            │
│  2. 数据分析（统计报表 → 漏斗分析）                          │
│  3. 自动化触达（私信 → 跟进 → 转化）                         │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                 📌 优化功能（逐步做）                         │
├─────────────────────────────────────────────────────────────┤
│  1. 智能推荐（AI匹配客户和产品）                             │
│  2. 效果AB测试                                              │
│  3. 微信生态获客                                            │
│  4. 直播获客                                                │
│  5. 高级报表可视化                                          │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 功能与工具对应表

| 功能模块 | 核心功能 | 呈现方式 | 优先级 |
|----------|----------|----------|--------|
| **客户搜索** | 是 | CLI/脚本 | P0 |
| **自动化触达** | 是 | CLI/脚本 | P0 |
| **CRM管理** | 是 | CLI/Web | P0 |
| **产品库** | 是 | Obsidian | P0 |
| **早报系统** | 是 | WhatsApp | P0 |
| **自媒体矩阵** | 否 | 平台App | P1 |
| **数据分析** | 否 | Web界面 | P1 |
| **电商监控** | 否 | CLI/脚本 | P2 |

---

## 🖥️ 三、呈现方式详解

### 3.1 各模块呈现方式

```
┌────────────────────────────────────────────────────────────────┐
│                        呈现方式总览                              │
├──────────────────┬─────────────────────────────────────────────┤
│                  │                                             │
│  ┌────────────┐ │  ┌────────────────────────────────────────┐ │
│  │ WhatsApp   │ │  │           Obsidian（知识库）           │ │
│  │ 消息推送   │ │  │  ┌──────────────────────────────────┐  │ │
│  │            │ │  │  │ 产品库 │ 模板 │ 知识库 │ 工具   │  │ │
│  └────────────┘ │  │  └──────────────────────────────────┘  │ │
│                  │  └────────────────────────────────────────┘ │
│  ┌────────────┐ │  ┌────────────────────────────────────────┐ │
│  │ CLI终端    │ │  │         Claude Code/OpenCode           │ │
│  │ 脚本工具   │ │  │  ┌──────────────────────────────────┐  │ │
│  │            │ │  │  │ 客户搜索 │ 触达 │ CRM命令行    │  │ │
│  └────────────┘ │  │  └──────────────────────────────────┘  │ │
│                  │  └────────────────────────────────────────┘ │
│  ┌────────────┐ │  ┌────────────────────────────────────────┐ │
│  │ Web界面    │ │  │          自建管理系统（未来）           │ │
│  │ (未来)     │ │  │  ┌──────────────────────────────────┐  │ │
│  │            │ │  │  │ 仪表盘 │ 客户管理 │ 数据分析 │  │ │
│  └────────────┘ │  │  └──────────────────────────────────┘  │ │
│                  │  └────────────────────────────────────────┘ │
└──────────────────┴─────────────────────────────────────────────┘
```

### 3.2 各工具职责

| 工具 | 职责 | 交互方式 | 用户 |
|------|------|----------|------|
| **Obsidian** | 产品库、知识库 | 本地App | 你 |
| **Claude Code/OpenCode** | 代码编写、运行 | 终端CLI | 我 |
| **Clawdbot** | AI对话、协调 | WhatsApp/微信 | 你 |
| **CRM CLI** | 客户管理 | 终端CLI | 我 |
| **早报系统** | 信息推送 | WhatsApp自动 | 你 |

---

## 🗄️ 四、数据库设计

### 4.1 数据存储方式

```
┌─────────────────────────────────────────────────────────────────┐
│                       数据存储架构                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                   文件存储（JSON/Markdown）              │   │
│  │                                                         │   │
│  │  /workspaces/MyMoltbot/                                 │   │
│  │  ├── obsidian-templates/  ← Obsidian知识库              │   │
│  │  │   ├── 产品库/                                        │   │
│  │  │   ├── 知识库/                                        │   │
│  │  │   └── 模板/                                          │   │
│  │  │                                                       │   │
│  │  ├── customer-monitor/                                  │   │
│  │  │   ├── data/                                          │   │
│  │  │   │   ├── leads_*.json      ← 搜索线索               │   │
│  │  │   │   ├── reach_tasks.json  ← 触达任务               │   │
│  │  │   │   └── platform_config.json                       │   │
│  │  │   └── templates/                                     │   │
│  │  │                                                       │   │
│  │  ├── crm-system/                                        │   │
│  │  │   └── data/                                          │   │
│  │  │       ├── customers.json    ← 客户数据               │   │
│  │  │       ├── followups.json    ← 跟进记录               │   │
│  │  │       └── deals.json        ← 成交记录               │   │
│  │  │                                                       │   │
│  │  ├── ecommerce-monitor/                                 │   │
│  │  │   └── data/                                          │   │
│  │  │       └── price_*.json                               │   │
│  │  │                                                       │   │
│  │  └── product-collector/                                 │   │
│  │      └── compare-update/                                │   │
│  │          └── data/                                      │   │
│  │              └── baseline_products.json                  │   │
│  │                                                         │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                   Git版本控制                            │   │
│  │                                                         │   │
│  │  GitHub ← 自动同步 → 本地文件                           │   │
│  │                                                         │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 4.2 核心数据结构

#### 客户数据 (customers.json)
```json
{
  "id": "c001",
  "name": "李先生",
  "phone": "13800138001",
  "source": "抖音",
  "status": "跟进中",
  "intent_level": "高意向",
  "product_type": "个人信用贷",
  "amount": 300000,
  "created_at": "2026-01-15 10:00",
  "next_followup": "2026-02-02"
}
```

#### 线索数据 (leads_关键词_时间.json)
```json
[
  {
    "id": "l001",
    "platform": "抖音",
    "content": "征信有逾期能贷款吗？",
    "author": "李先生",
    "intent_score": 85,
    "intent_level": "高意向",
    "url": "https://..."
  }
]
```

#### 触达任务 (reach_tasks.json)
```json
[
  {
    "id": "t001",
    "lead_id": "l001",
    "platform": "抖音",
    "content": "私信内容...",
    "status": "已发送",
    "sent_at": "2026-02-01 10:00"
  }
]
```

### 4.3 数据流转

```
┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐
│ 客户搜索  │ → │ 线索数据  │ → │ 触达任务  │ → │  客户    │
│ (CLI)    │    │ (JSON)   │    │ (JSON)   │    │ (CRM)    │
└──────────┘    └──────────┘    └──────────┘    └──────────┘
     │                                               │
     └───────────────────────────────────────────────┘
                      ↓
              ┌──────────────┐
              │   Obsidian   │
              │   产品库     │
              └──────────────┘
```

---

## 🔄 五、数据流与交互

### 5.1 完整数据流

```
                              用户(你)
                                │
                                ▼
┌───────────────────────────────────────────────────────────────┐
│                     Clawdbot (AI协调层)                       │
│  理解需求 → 规划方案 → 调用工具 → 返回结果                     │
└───────────────────────────────────────────────────────────────┘
           │                    │                    │
           ▼                    ▼                    ▼
    ┌────────────┐      ┌────────────┐      ┌────────────┐
    │ Obsidian   │      │ CLI脚本    │      │ Claude     │
    │ 产品库     │      │ (搜索/触达)│      │ Code       │
    │ (查询)     │      │ (执行)     │      │ (写代码)   │
    └────────────┘      └────────────┘      └────────────┘
           │                    │                    │
           └────────────────────┼────────────────────┘
                                ▼
                        ┌────────────┐
                        │  JSON文件  │
                        │ (数据存储) │
                        └────────────┘
                                │
                                ▼
                        ┌────────────┐
                        │   GitHub   │
                        │ (备份同步) │
                        └────────────┘
```

### 5.2 各模块交互

| 交互场景 | 调用链 | 呈现 |
|----------|--------|------|
| **查产品** | WhatsApp → Clawdbot → Obsidian | WhatsApp返回 |
| **搜客户** | WhatsApp → Clawdbot → CLI脚本 | 报告发WhatsApp |
| **管客户** | 终端 → CRM CLI | 终端输出 |
| **写代码** | Clawdbot → Claude Code | 文件生成 |
| **看数据** | Obsidian | 本地App |
| **自动化** | Cron → 早报脚本 | WhatsApp推送 |

---

## 📋 六、模块依赖关系

```
┌─────────────────────────────────────────────────────────────────┐
│                        核心依赖关系                              │
│                                                                 │
│  ┌─────────┐                                                   │
│  │Clawdbot │ ← 你(WhatsApp/微信)                               │
│  └────┬────┘                                                   │
│       │                                                        │
│       ├──┬─────────────────────┬────────────────────────────┐  │
│       │  │                     │                            │  │
│       ▼  ▼                     ▼                            ▼  │
│  ┌─────────┐           ┌─────────┐                  ┌─────────┐│
│  │Obsidian │           │CLI脚本  │                  │Claude   ││
│  │产品库   │           │搜索/触达│                  │Code     ││
│  └─────────┘           └────┬────┘                  └─────────┘│
│                            │                              │    │
│                            ▼                              │    │
│                     ┌─────────────┐                       │    │
│                     │  JSON数据   │ ←─────────────────────┘    │
│                     └─────────────┘                            │
│                            │                                   │
│                            ▼                                   │
│                     ┌─────────────┐                            │
│                     │   GitHub    │                            │
│                     └─────────────┘                            │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 🎯 七、核心功能详解

### 7.1 客户获取（核心）

```
客户获取
│
├── 客户搜索 (CLI)
│   ├── 搜索引擎（百度/知乎）
│   ├── 社交媒体（抖音/小红书）
│   └── 房产平台（贝壳/链家）
│
├── 自动化触达 (CLI)
│   ├── 私信发送
│   ├── 评论互动
│   └── 短信触达
│
└── CRM管理 (CLI/Web)
    ├── 客户信息
    ├── 跟进记录
    └── 成交追踪

呈现：CLI终端 + 未来Web界面
数据：JSON文件
```

### 7.2 产品管理（核心）

```
产品管理
│
├── 产品库 (Obsidian)
│   ├── 国有银行（工行/建行/农行/中行/交行）
│   ├── 股份制银行（招行/浦发/中信/光大/民生/平安/兴业/华夏/广发）
│   ├── 城商行（湖北银行/汉口银行/北京银行）
│   ├── 互联网银行（微众/网商）
│   └── 消费金融（湖北消金/中银消金/招联等）
│
├── 产品对比 (CLI)
│   ├── 利率对比
│   ├── 额度对比
│   └── 更新监控
│
└── 公积金产品 (Obsidian)
    └── 18家银行公积金贷款

呈现：Obsidian本地App
数据：Markdown文件 + JSON
```

### 7.3 效率工具（核心）

```
效率工具
│
├── 早报系统 (自动)
│   ├── 贷款产品
│   ├── 自媒体热点
│   ├── 行业新闻
│   ├── 天气
│   └── LPR利率
│
├── 工作台看板 (Obsidian)
│   ├── 工具状态
│   ├── 客户线索
│   └── 任务清单
│
└── 任务管理 (CLI)
    ├── 待办列表
    └── 进度跟踪

呈现：WhatsApp推送 + Obsidian
数据：JSON文件
```

---

## 📊 八、当前vs未来

### 8.1 当前状态（已实现）

| 模块 | 呈现 | 数据 | 状态 |
|------|------|------|------|
| 产品库 | Obsidian App | Markdown | ✅ 完成 |
| 客户搜索 | CLI终端 | JSON | ✅ 完成 |
| 自动化触达 | CLI终端 | JSON | ✅ 完成 |
| CRM管理 | CLI终端 | JSON | ✅ 完成 |
| 早报系统 | WhatsApp自动推送 | JSON | ✅ 完成 |
| 电商监控 | CLI终端 | JSON | ✅ 完成 |
| 工作台看板 | Obsidian | Markdown | ✅ 完成 |

### 8.2 未来规划（待开发）

| 模块 | 呈现 | 数据 | 优先级 |
|------|------|------|--------|
| CRM Web界面 | Web App | SQLite | P0 |
| 数据可视化 | Web App | SQLite | P1 |
| 自媒体管理 | 各平台App | API | P1 |
| 微信生态 | 微信小程序 | API | P2 |
| 直播获客 | 抖音App | 手动 | P2 |

---

## 💡 一句话总结

| 问题 | 答案 |
|------|------|
| **核心功能是什么？** | 客户获取 + 产品管理 + 效率工具 |
| **怎么呈现？** | Obsidian(产品) + CLI(搜索/触达) + WhatsApp(推送) |
| **数据库在哪？** | JSON文件 + Markdown文件 + GitHub同步 |
| **未来怎么发展？** | 添加Web界面 + 数据可视化 |

---

*文档由 AI 自动生成*
